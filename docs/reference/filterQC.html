<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter &amp; QC Samples — filterQC • SCWorkflow</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter &amp; QC Samples — filterQC"><meta property="og:description" content="Filters cells and Genes for each sample and generates QC Plots
to evaluate data before and after filtering."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCWorkflow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter &amp; QC Samples</h1>
    
    <div class="hidden name"><code>filterQC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Filters cells and Genes for each sample and generates QC Plots
to evaluate data before and after filtering.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filterQC</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  min.cells <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  filter.vdj.genes <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  nfeature.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  mad.nfeature.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  ncounts.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  mad.ncounts.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  mitoch.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  mad.mitoch.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  complexity.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  mad.complexity.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  topNgenes.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  mad.topNgenes.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  n.topgnes <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  do.doublets.fitler <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  plot.outliers <span class="op">=</span> <span class="st">"FALSE"</span>,</span>
<span>  group.column <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nfeatures <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  low_cut <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  high_cut <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  low_cut_disp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  high_cut_disp <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  selection_method <span class="op">=</span> <span class="st">"vst"</span>,</span>
<span>  npcs <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  integratedata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clust_res_low <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  clust_res_high <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  clust_res_bin <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  only_var_genes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed_for_PCA <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  seed_for_TSNE <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed_for_UMAP <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a list of seurat objects for each sample.</p></dd>


<dt>min.cells</dt>
<dd><p>Filter out genes found in less than this number of cells.
E.g. Setting to 20 will remove genes found in fewer than 3 cells of
a sample. (Default: 20)</p></dd>


<dt>filter.vdj.genes</dt>
<dd><p>If FALSE to remove VDJ genes from the scRNA
transcriptome assay. This is to prevent clustering bias in T-cells of the
same clonotype. Only recommended if you are also doing TCR-seq.
(Default: FALSE)</p></dd>


<dt>nfeature.limits</dt>
<dd><p>Filter out cells where the number of genes found in each
cell exceed the selected lower or upper limits.
Usage c(lower limit, Upper Limit). E.g. setting to c(200,1000) will remove
cells that have fewer than 200 genes or more than 1000 genes
for each sample. (Default: c(NA, NA))</p></dd>


<dt>mad.nfeature.limits</dt>
<dd><p>Set filter limits based on how many Median
Absolute Deviations an outlier cell will have. Calculated from the median
gene number for all cells in your sample. Usage c(lower limit, Upper Limit)
E.g. setting to c(3,5) will remove all cells with more than 3 absolute
deviations less than the median or 5 absolute deviations greater than the
median. (Default: c(5,5))</p></dd>


<dt>ncounts.limits</dt>
<dd><p>Filter out cells where the total number of molecules
(umi) detected within a cell exceed the selected limits.
Usage c(lower limit, Upper Limit). E.g. setting to c(200,100000) will remove
cells that have fewer than 200 or greater than 100000 molecules.
(Default: c(NA, NA))</p></dd>


<dt>mad.ncounts.limits</dt>
<dd><p>Set filter limits based on how many Median Absolute
Deviations an outlier cell will have. Calculated from the median number of
molecules for all cells in your sample. Usage c(lower limit, Upper Limit)
E.g. setting to c(3,5) will remove all cells with more than 3 absolute
deviations less than the median or with more than 5 absolute deviations
greater than the median. (Default: c(5,5))</p></dd>


<dt>mitoch.limits</dt>
<dd><p>Filter out cells whose proportion of mitochondrial genes
exceed the selected lower or upper limits.
Usage c(lower limit, Upper Limit). E.g. setting to c(0,8) will not set the
lower limit and removes cells with more than 8% mitochondrial RNA.
(Default: c(NA,8))</p></dd>


<dt>mad.mitoch.limits</dt>
<dd><p>Set filter limits based on how many Median Absolute
Deviations an outlier cell will have. Calculated from the Median percentage
of mitochondrial RNA for all cells in your sample.
Usage c(lower limit, Upper Limit). E.g. setting to c(NA,3) will not set a
lower limit and remove all cells with more than 3 absolute deviations
greater than the median. (Default: c(NA,3))</p></dd>


<dt>complexity.limits</dt>
<dd><p>Complexity represents Number of genes detected per
UMI. The more genes detected per UMI, the more complex the data.
Filter out cells whose Complexity exceed the selected lower or upper limits.
Cells that have a high number of UMIs but only a low number of genes could
be dying cells, but also could represent a population of a low complexity
cell type (i.e red blood cells). We suggest that you set the lower limit to
0.8 if samples have suspected RBC contamination.
Usage c(lower limit, Upper Limit). E.g. setting to c(0.8,0) will not set
an upper limit and removes cells with complexity less than 0.8.
(Default: c(NA,NA))</p></dd>


<dt>mad.complexity.limits</dt>
<dd><p>Set filter limits based on how many Median
Absolute Deviations an outlier cell will have. Calculated from the Median
complexity for all cells in your sample.
Usage c(lower limit, Upper Limit). E.g. setting to c(5,NA) will not set an
upper limit and remove all cells with  more than 5 absolute deviations
less than the median. (Default: c(5,NA))</p></dd>


<dt>topNgenes.limits</dt>
<dd><p>Filter Cells based on the percentage of total counts
in top N most highly expressed genes. Outlier cells would have a high
percentage of counts in just a few genes and should be removed.
The same considerations outlined in "complexity.limits" should be taken for
this filter.
Usage c(lower limit, Upper Limit). E.g. setting to c(NA,50) will not set a
lower limit and remove cells with greater than 50% of reads in the top N
genes. (Default: c(NA,NA))</p></dd>


<dt>n.topgnes</dt>
<dd><p>Select the number of top highly expressed genes used to
calculate the percentage of reads found in these genes.
E.g. a value of 20 calculates the percentage of reads found in the top 20
most highly expressed Genes.
(Default: 20)</p></dd>


<dt>do.doublets.fitler</dt>
<dd><p>Use scDblFinder to identify and remove doublet
cells. Doublets are defined as two cells that are sequenced under the same
cellular barcode, for example, if they were captured in the same droplet.
(Default: TRUE)</p></dd>


<dt>mad.topNgenes.limitsSet</dt>
<dd><p>Filter limits based on how many Median
Absolute Deviations an outlier cell will have. Calculated from the Median
percentage of counts in the top N Genes.
Usage c(lower limit, Upper Limit). E.g. setting to c(5,5) will remove all
cells with more than 5 absolute deviations greater than or 5 absolute
deviations less than the median percentage. (Default: c(5,5))</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Seurat Object and QC plots</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This is Step 2 in the basic Single-Cell RNA-seq workflow. Multiple
cell and gene filters can be selected to remove poor quality data and noise.
Returns data as a Seurat Object, and a variaty of figues to evaluate the
quality of data and the effect of applied filters.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Maggie Cam, Thomas Meyer, Jing Bian, Alexandra Michalowski, Alexei Lobanov, Philip Homan, Rui He.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

